list_lazada=["https://www.lazada.co.id/products/ambipur-car-aqua-ultra-control-75ml-i1441222392-s2658062009.html",
"https://www.lazada.co.id/products/ambipur-car-fresh-cool-ultra-control-i1441200693-s2658000886.html",
"https://www.lazada.co.id/products/ambipur-car-vanilla-bouquet-ultra-control-75ml-i1441234305-s2658046536.html",
"https://www.lazada.co.id/products/ambipur-car-lavender-spa-ultra-control-75ml-i1441248060-s2658060046.html",
"https://www.lazada.co.id/products/ambipur-car-fresh-and-light-ultra-control-75ml-i1441238226-s2658038779.html",
"https://www.lazada.co.id/products/ambipur-car-vanilla-bouquet-refill-i1441230292-s2658030274.html",
"https://www.lazada.co.id/products/ambipur-car-aqua-refill-75ml-i1441248059-s2658056079.html",
"https://www.lazada.co.id/products/ambi-pur-pengharum-mobil-fresh-and-light-refill-75-ml-i1441236255-s2658054066.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-sunrise-fresh-15-l-paket-isi-3-i4805198301-s8822088842.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-mystique-145-l-paket-isi-3-i4805118993-s8822092981.html",
"https://www.lazada.co.id/products/downy-plus-collection-anti-apek-pelembut-pewangi-pakaian-konsentrat-15l-paket-isi-3-i580940234-s822414235.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-passion-145-l-paket-isi-3-i4805206129-s8822108612.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-french-lavender-145-l-paket-isi-3-i6068222210-s11638138773.html",
"https://www.lazada.co.id/products/downy-sunrise-fresh-refill-780ml-pack-of-4-i965894427-s1455398900.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-fresh-bouquet-145-l-paket-isi-3-i5436636272-s10820862716.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-adorable-bouquet-145-l-paket-isi-3-i5436670016-s10820906158.html",
"https://www.lazada.co.id/products/downy-passion-refill-720ml-pack-of-4-i963656005-s1453010477.html",
"https://www.lazada.co.id/products/downy-mystique-refill-720ml-pack-of-4-i963512992-s1452908667.html",
"https://www.lazada.co.id/products/downy-daring-refill-720ml-pack-of-4-i965280503-s1454784517.html",
"https://www.lazada.co.id/products/downy-sunrise-fresh-refill-800ml-paket-isi-3-i160034505-s181900788.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-adorable-bouquet-550-ml-paket-isi-3-i5436594759-s10820900336.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-floral-pink-15-l-paket-isi-3-i4805186341-s8822178063.html",
"https://www.lazada.co.id/products/downy-mild-gentle-720ml-paket-isi-3-i1078152572-s1684632379.html",
"https://www.lazada.co.id/products/downy-pewangi-dan-pelembut-pakaian-konsentrat-daring-145-l-paket-isi-3-i4805202182-s8822120473.html",
"https://www.lazada.co.id/products/gillette-blue-ii-plus-elastomer-handle-disposable-sensitive-razor-10s-paket-isi-2-i5828624448-s11288406748.html",
"https://www.lazada.co.id/products/gillette-pisau-cukur-silet-london-bridge-20-box-i4188394485-s7063678065.html",
"https://www.lazada.co.id/products/gillette-alat-cukur-vector-refill-isi-4-pisau-cukur-isi-ulang-paket-isi-2-i3205830860-s5604718381.html",
"https://www.lazada.co.id/products/gillette-blue-ii-plus-elastomer-handle-disposable-sensitive-10s-free-gillette-standee-i160040608-s181911602.html",
"https://www.lazada.co.id/products/gillette-alat-cukur-fusion-proglide-isi-4-refill-pisau-cukur-isi-ulang-paket-isi-2-i3205878361-s5604712498.html",
"https://www.lazada.co.id/products/gillette-shaving-foam-krim-alat-cukur-lemon-lime-175g-shaving-cream-paket-isi-2-i3204984214-s5603574290.html",
"https://www.lazada.co.id/products/gillette-vector-razor-1s-i159974040-s181773171.html",
"https://www.lazada.co.id/products/gillette-shaving-foam-krim-alat-cukur-menthol-175g-shaving-cream-paket-isi-2-i3205864705-s5604696928.html",
"https://www.lazada.co.id/products/gillette-alat-cukur-blue-3-biru-razor-pisau-cukur-isi-4-i1500020782-s2820944514.html",
"https://www.lazada.co.id/products/gillette-alat-cukur-mach-3-isi-4-refill-pisau-cukur-isi-ulang-paket-isi-2-i3205868476-s5604676945.html",
"https://www.lazada.co.id/products/gillette-fusion5-pisau-cukur-isi-ulang-razor-alat-cukur-i5786710627-s11243670097.html",
"https://www.lazada.co.id/products/gillette-cartridge-mach-3-isi-4-i159925906-s181717131.html",
"https://www.lazada.co.id/products/gillette-cartridge-vector-isi-4-i159973954-s181773064.html",
"https://www.lazada.co.id/products/gillette-fusion5-proglide-pisau-cukur-isi-ulang-razor-alat-cukur-i5786730465-s11243660491.html",
"https://www.lazada.co.id/products/gillette-fusion-proglide-manual-cartridge-4s-free-gillette-standee-i160025257-s181874737.html",
"https://www.lazada.co.id/products/gillette-fusion-proglide-manual-cartridge-2s-free-gillette-standee-i159925772-s181715976.html",
"https://www.lazada.co.id/products/gillette-fusion-proglide-alat-cukur-razor-pisau-cukur-isi-ulang-i160007964-s181833997.html",
"https://www.lazada.co.id/products/gillette-alat-cukur-blue-2-flexi-razor-pisau-cukur-isi-15-i5786704014-s11243620399.html",
"https://www.lazada.co.id/products/gillette-mach3-turbo-4s-refill-isi-ulang-pisau-alat-cukur-i1500050259-s2820924664.html",
"https://www.lazada.co.id/products/gillette-gel-cool-fusion-proglide-195gr-krim-cukur-i1500008844-s2820966117.html",
"https://www.lazada.co.id/products/head-shoulders-shampoo-menthol-850ml-paket-isi-3-i985748057-s1479894669.html",
"https://www.lazada.co.id/products/beli-3-promo-spesial-head-shoulders-cool-menthol-shampoo-400ml-perawatan-rambut-kulit-kepala-shamposampo-anti-ketombe-i160030857-s181890148.html",
"https://www.lazada.co.id/products/head-shoulders-shampoo-lemon-fresh-850ml-paket-isi-3-i985866392-s1480044295.html",
"https://www.lazada.co.id/products/head-shoulders-shampoo-smooth-and-silky-400-ml-paket-isi-3-i5829986114-s11289650525.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-clean-white-strawberry-sweet-mint-shampo-400-ml-kondisioner-i637782809-s886824837.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-repair-argan-oil-of-morocco-shampo-400-ml-kondisioner-i637844345-s886892790.html",
"https://www.lazada.co.id/products/herbal-essences-clean-white-strawberry-sweet-mint-shampo-400x2-dan-conditioner-400ml-i4160206275-s7014814832.html",
"https://www.lazada.co.id/products/herbal-essences-argan-oil-of-morocco-shampoo-400-ml-x2-dan-conditioner-400ml-i4160194389-s7014784867.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-repair-argan-oil-of-morocco-shampo-400-ml-x2-i637674106-s886592249.html",
"https://www.lazada.co.id/products/herbal-essences-shampo-kondisioner-hello-hydration-300-ml-i956000257-s1440728054.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-clean-white-strawberry-sweet-mint-shampo-400-ml-x2-i637628966-s886576500.html",
"https://www.lazada.co.id/products/herbal-essences-colour-me-happy-300ml-shampoo-x2-dan-conditioner-300ml-i4160182621-s7014802884.html",
"https://www.lazada.co.id/products/herbal-essences-shampoo-hello-hydration-300-ml-x2-dan-conditioner-300ml-i4160208206-s7014786713.html",
"https://www.lazada.co.id/products/herbal-essences-hydrate-coconut-milk-shampoo-400-ml-x2-dan-conditioner-400ml-i4160166789-s7014838437.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-hydrate-coconut-milk-shampo-400-ml-kondisioner-i637822592-s886882437.html",
"https://www.lazada.co.id/products/herbal-essences-biorenew-smooth-golden-moringa-oil-shampo-400-ml-kondisioner-i637638980-s886582511.html",
"https://www.lazada.co.id/products/herbal-essences-shampo-kondisioner-moroccan-my-shine-300-ml-i956152832-s1441056907.html",
"https://www.lazada.co.id/products/herbal-essences-smooth-golden-moringa-oil-shampoo-400-ml-x2-dan-conditioner-400ml-i4160184657-s7014828746.html",
"https://www.lazada.co.id/products/herbal-essences-shampoo-moroccan-my-shine-300-ml-x2-dan-conditioner-300ml-i4160180644-s7014770962.html",
"https://www.lazada.co.id/products/herbal-essences-colour-me-happy-paket-shampoo-300-ml-conditioner-300-ml-i955706312-s1440400846.html",
"https://www.lazada.co.id/products/herbal-essences-argan-oil-shampoo-400-ml-dan-white-strawberry-400ml-dan-grapefruit-400ml-i4160192379-s7014846162.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-perawatan-anti-aging-skincare-cream-wajah-glowing-krim-wajah-bpom-i160036241-s181904937.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-serum-perawatan-anti-aging-gratis-olay-regenerist-microsculpting-serum-mini-14gr-skincare-i848508480-s1220858172.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-day-cream-normal-spf-15-7-in-1-50gr-i159990415-s181800274.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-lengkap-serum-regenerist-gratis-olay-regenerist-microsculpting-serum-mini-14gr-skincare-i848470612-s1220804191.html",
"https://www.lazada.co.id/products/olay-advanced-anti-aging-pelembab-regenerist-micro-sculpting-serum-50ml-skincare-cream-wajah-glowing-krim-wajah-bpom-serum-wajah-i159951474-s181747273.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-lengkap-serum-perawatan-anti-aging-gratis-olay-regenerist-microsculpting-serum-mini-14gr-skincare-i848572316-s1220904280.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-night-cream-7-in-1-50gr-i160017264-s181852075.html",
"https://www.lazada.co.id/products/olay-regenerist-retinol-24-moisturiser-pelembab-krim-wajah-50g-i1623396805-s3132396239.html",
"https://www.lazada.co.id/products/olay-white-radiance-luminuous-krim-pelembab-uv-50-g-i5739186255-s11191616414.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-ritual-pelembab-anti-aging-skincare-cream-wajah-glowing-krim-wajah-bpom-i160036240-s181904936.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-serum-regenerist-gratis-olay-regenerist-microsculpting-serum-mini-10gr-skincare-i848480120-s1220722776.html",
"https://www.lazada.co.id/products/olay-whitening-pencerah-white-radiance-light-perfecting-night-cream-pemutih-wajah-50g-i160017507-s181852548.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-serumwajah-7-in-1-50ml-skincare-cream-wajah-glowing-krim-wajah-bpom-serum-wajah-i160017268-s181852079.html",
"https://www.lazada.co.id/products/olay-regenerist-revitalising-hydration-uv-cream-50g-i159951278-s181747057.html",
"https://www.lazada.co.id/products/i5520674565.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-touch-of-foundation-bb-cream-spf-15-7-in-1-50g-skincarecream-wajah-glowingkrim-wajah-bpom-i159962240-s181759620.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-perawatan-kulit-normal-i160040644-s181911638.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-day-cream-gentle-spf-15-7-in-1-50gr-i159973683-s181772773.html",
"https://www.lazada.co.id/products/olay-regenerist-retinol-24-serum-30ml-i1623424336-s3132330891.html",
"https://www.lazada.co.id/products/olay-regenerist-collagen-peptide-24-krim-pelembab-50-g-i5738692959-s11191194700.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-paket-serum-anti-aging-skincare-i848344276-s1220552732.html",
"https://www.lazada.co.id/products/olay-white-radiance-niacinamide-vitamin-c-super-serum-i4804630684-s8821724261.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-lengkap-perawatan-anti-aging-skincare-cream-wajah-glowing-krim-wajah-bpom-i719920779-s996534453.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-regenerist-ritual-set-lengkap-anti-aging-i5121078032-s9519554397.html",
"https://www.lazada.co.id/products/olay-anti-aging-pelembab-total-effects-7-in-1-day-cream-normal-50gr-i160017260-s181852071.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-pencerah-whitening-wr-day-50gr-wr-night-50gr-wr-essence-30ml-i4188888117-s7064492301.html",
"https://www.lazada.co.id/products/olay-regenerist-revitalising-night-cream-50gr-i159951522-s181747325.html",
"https://www.lazada.co.id/products/lebih-hemat-olay-set-perawatan-anti-aging-gentle-skincare-i847176672-s1217722094.html",
"https://www.lazada.co.id/products/olay-regenerist-mircro-sculpting-cream-night-50gr-i160017480-s181852521.html",
"https://www.lazada.co.id/products/ritual-retinol-anti-aging-krim-pagi-50g-krim-malam-50g-i1676214909-s3249010714.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-all-rounder-123-soft-3s-paket-isi-6-i3260218426-s5671746266.html",
"https://www.lazada.co.id/products/oral-b-dental-flossbenang-gigi-essential-50m-paket-isi-6-i3205904224-s5604732455.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-stages-1-paket-isi-6-i3260220419-s5671750273.html",
"https://www.lazada.co.id/products/oral-b-dental-flossbenang-gigi-satin-50m-paket-isi-6-i3205916070-s5604724508.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-stages-2-paket-isi-6-i3260160058-s5671626488.html",
"https://www.lazada.co.id/products/oral-b-pasta-gigi-tooth-and-gum-care-paste-paket-isi-6-i4190414031-s7068956737.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-stages-3-paket-isi-6-i3260112650-s5671600927.html",
"https://www.lazada.co.id/products/oral-b-bilas-mulut-rinse-prohealth-500ml-paket-isi-6-i3265150852-s5679562755.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-all-rounder-fresh-clean-black-3s-paket-isi-6-i4190394516-s7068986620.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-ultrathin-green-tea-3s-paket-isi-6-i3250288558-s5660482135.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-anak-mickey-2-4-tahun-paket-isi-3-i5669508537-s11114564630.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-ultrathin-black-tea-3s-paket-isi-6-i3250326207-s5660470263.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-toothbrush-complete-easy-clean-charcoal-3s-i6223260807-s11826316554.html",
"https://www.lazada.co.id/products/oral-b-sikat-gigi-stages-4-paket-isi-6-i3260162051-s5671614911.html",
"https://www.lazada.co.id/products/oral-b-fresh-clean-black-soft-3s-i954382760-s1438692310.html",
"https://www.lazada.co.id/products/pantene-shampoo-hair-fall-control-900ml-paket-isi-3-i805056346-s1137754064.html",
"https://www.lazada.co.id/products/pantene-shampoo-anti-dandruff-900ml-pack-of-3-i805076382-s1137776456.html",
"https://www.lazada.co.id/products/pantene-shampoo-hair-fall-control-400ml-paket-isi-3-i160035339-s181903353.html",
"https://www.lazada.co.id/products/beli-3-promo-spesial-pantene-shampoo-anti-dandruff-400ml-perawatan-rambut-shamposampo-anti-ketombe-i160035338-s181903352.html",
"https://www.lazada.co.id/products/pantene-shampoo-anti-lepek-900ml-paket-isi-3-i4195290459-s7075926705.html",
"https://www.lazada.co.id/products/pantene-shampoo-hair-fall-control-1800-ml-paket-isi-3-i4644782375-s8163010569.html",
"https://www.lazada.co.id/products/pantene-shampoo-hairfall-1200ml-paket-isi-3-i984874132-s1479340609.html",
"https://www.lazada.co.id/products/pantene-conditioner-miracles-biotin-strength-daily-hair-supplement-for-hairfall-control-150ml-x2-i5826042309-s11285894961.html",
"https://www.lazada.co.id/products/rejoice-shampoo-rich-600ml-paket-isi-2-halus-lembut-i160040639-s181911633.html",
"https://www.lazada.co.id/products/gillette-daisy-alat-cukur-wanita-isi-5-razor-pisau-cukur-paket-isi-2-i963184888-s1452240084.html",
"https://www.lazada.co.id/products/gillette-daisy-plus-razor-2s-i961176696-s1449452001.html",
"https://www.lazada.co.id/products/gillette-simply-venus-2s-paket-isi-4-i5828568757-s11288376587.html",
"https://www.lazada.co.id/products/gillette-venus-alat-cukur-wanita-sensitive-isi-3-razor-pisau-cukur-paket-isi-2-i3205854639-s5604686883.html",
"https://www.lazada.co.id/products/gillette-venus-krim-alat-cukur-wanita-satin-care-aloe-vera-i5426754707-s10793574993.html",
"https://www.lazada.co.id/products/i5422900008.html",
"https://www.lazada.co.id/products/gillette-venus-alat-cukur-wanita-smooth-sensitive-razor-pisau-cukur-isi-ulang-i5418748377-s10764004613.html",
"https://www.lazada.co.id/products/gillette-simply-venus-hybrid-4up-i953908538-s1437848672.html",
"https://www.lazada.co.id/products/gillette-venus-alat-cukur-wanita-simply-venus-isi-2-razor-pisau-cukur-paket-isi-2-pack-i3205902028-s5604716384.html",
"https://www.lazada.co.id/products/vicks-vaporub-50g-i1438336272-s2650080972.html",
"https://www.lazada.co.id/products/vicks-vaporub-10g-i1438362099-s2650130747.html",
"https://www.lazada.co.id/products/vicks-vaporub-25g-i1438332329-s2650112634.html",
"https://www.lazada.co.id/products/vicks-inhaler-05ml-i1438302826-s2650164034.html"]
from bs4 import BeautifulSoup 
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.support.ui import WebDriverWait
import time
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from alive_progress import alive_bar
# capa = DesiredCapabilities.CHROME
# capa["pageLoadStrategy"] = "none"
options = Options()
options.add_experimental_option("excludeSwitches", ["enable-automation"])
options.add_experimental_option('useAutomationExtension', False)
options.add_argument('--disable-blink-features=AutomationControlled')
options.add_argument('--disable-notifications')
# options.add_argument('--headless')
prefs = {"profile.managed_default_content_settings.images": 2}
options.add_experimental_option("prefs", prefs)
from selenium.webdriver.firefox.service import Service
driver=webdriver.Chrome(options=options)
# driver.set_page_load_timeout(10)
wait=WebDriverWait(driver,20)
from selenium.webdriver.common.action_chains import ActionChains
list_rating=[]
list_count=[]

with alive_bar(len(list_lazada),title='gathering data....') as bar:
    for i in list_lazada:
        driver.get(i)
        ac=ActionChains(driver)
        # try:
        #     slider=driver.find_element(By.XPATH,'//*[@id="nc_1_n1z"]')
        #     print("ada")
        #     ac.click_and_hold(slider).pause(1).move_by_offset(100,0).release().perform()
        #     time.sleep(100)
        # except:
        #     pass
        wait.until(EC.presence_of_element_located((By.CSS_SELECTOR,'#module_product_review_star_1 > div > a:nth-child(2)')))
        
        for i in range(0,4):
            ac.scroll_by_amount(0,500).perform()
            time.sleep(1)
        soup=BeautifulSoup(driver.page_source,'html.parser')
        try:
            count=soup.find('a',{'class':"pdp-link pdp-link_size_s pdp-link_theme_blue pdp-review-summary__link"}).text
            rr=soup.find('span',{'class':"score-average"}).text
            list_rating.append(rr)
            list_count.append(count)
        except:
            list_count.append(0)
            list_rating.append(0)
        print(list_rating)
        # if len(list_lazada)%100==0:
        #     driver.quit()
        #     driver=webdriver.Chrome(options=options)
        # bar()
import pandas as pd
df=pd.DataFrame(data=[list_lazada,list_count,list_rating]).T
df.to_excel('rr_lazada_31_08.xlsx')
#nc_1_n1z